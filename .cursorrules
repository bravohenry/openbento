# OpenBento - Cursor Rules

## 📌 分形文档系统守护者规则

**你是这个分形系统的守护者。任何时候你感到逻辑模糊，请先通过更新各级 MD 来校准你的认知。**

### 核心同步协议（Mandatory）

1. **"原子更新规则"**：任何功能、架构、写法更新，必须在代码修改完成后，【立即同步更新】对应目录或子文档。
2. **"逆向触发链"**：文件变更 → 更新文件 Header → 更新所属文件夹 `.folder.md` →（若影响全局）更新主 `README.md`。
3. **"分形自洽"**：确保系统在任何一个子目录下，都能通过该目录的 MD 重建局部世界观。

### 文档层级结构

- **层级一：根目录主控文档**（`README.md`）- 系统的"灵魂"与强制法规
- **层级二：文件夹级架构说明**（`.folder.md`）- 局部地图（三行极简原则：地位、逻辑、约束）
- **层级三：文件开头注释**（文件 Header）- 细粒度信息（In/Out/Pos 协议）

### 文件 Header 格式

所有关键文件必须包含以下格式的 Header：

```typescript
/**
 * [INPUT]: (参数列表) - 输入说明
 * [OUTPUT]: (返回值列表) - 输出说明
 * [POS]: 位置说明 - 在系统中的位置和作用
 * 
 * [PROTOCOL]:
 * 1. 一旦本文件逻辑变更，必须同步更新此 Header。
 * 2. 更新后必须上浮检查所属文件夹 .folder.md 的描述是否依然准确。
 */
```

### 文件夹 .folder.md 格式

所有主要文件夹必须包含 `.folder.md` 文件，遵循三行极简原则：

```markdown
# Folder: /path/to/folder

1. **"地位"**：在系统中的地位和作用
2. **"逻辑"**：核心逻辑流程
3. **"约束"**：必须遵守的约束条件

## 🧩 成员清单

- `file1.tsx`：文件说明
- `file2.tsx`：文件说明

⚠️ **触发器**：一旦本文件夹新增或文件架构逻辑调整，请立即重写此文档。
```

### 更新传播规则

当修改代码时，必须遵循以下传播链：

1. **修改文件** → 更新文件 Header（如果逻辑变更）
2. **修改文件** → 检查所属文件夹 `.folder.md` 是否需要更新
3. **修改文件夹结构** → 更新文件夹 `.folder.md`
4. **影响全局架构** → 更新根目录 `README.md`

### 代码规范

- 使用 TypeScript，严格类型检查
- 遵循 React Hooks 最佳实践
- 使用 Compound Component 模式（如 BentoCard）
- 所有组件必须支持主题切换
- 严禁硬编码颜色和尺寸，必须使用设计令牌

### 项目结构

- `/src/bento` - Bento 卡片系统核心
- `/src/design-system` - 设计系统
- `/src/app` - Next.js 路由和页面
- `/src/components` - 通用组件

### 注意事项

- 所有文档更新必须在代码修改后立即完成
- 如果发现文档与代码不一致，优先更新文档以反映当前代码状态
- 在添加新功能时，必须同时更新相关文档
- 删除功能时，必须同时删除相关文档

